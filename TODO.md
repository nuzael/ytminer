# YTMiner Roadmap / TODO

## Phase 1 — Data Enrichment (Transcripts)
- [x] Implement transcript retrieval for public videos via YouTube timedtext endpoint
  - [x] Preferred languages from env (e.g., `en,pt,es`)
  - [x] Fallback to auto-generated captions when available
  - [x] Basic VTT/XML to plain text parsing
  - [x] Robust error handling and telemetry (basic)
  - [x] Detect YouTube blocking (403, HTML responses)
  - [x] Graceful fallback when transcripts are blocked
- [x] CLI/Interactive option to enable/disable transcript fetching
- [x] Store transcript metadata (video_id, language, source, has_autogenerated) in-memory for now
- [x] Lightweight file caching with `YTMINER_CACHE_DIR` support
- [x] Unit tests for XML parsing and language fallback
- [x] OAuth2Fetcher structure prepared for future YouTube Data API v3 integration

## Phase 2 — Temporal Persistence
- [ ] Introduce persistence layer (SQLite by default) for daily metrics snapshots
  - [ ] Schema: `video_metrics_daily(video_id, date, views, likes, comments)`
  - [ ] Background job/scheduled task to refresh recent videos (e.g., last 30–90 days)
  - [ ] Upsert semantics, idempotency, and API quota awareness
- [x] Feature calculations from daily series
  - [x] VPD7, VPD30, slope (linear regression) - implemented in-memory
  - [x] like_rate, comment_rate, freshness (age bucket) - implemented
  - [ ] Half-life calculation (deferred to Phase 2)

## Phase 3 — Embeddings & Clustering
- [ ] Generate text embeddings (title + description + transcript)
  - [ ] Pluggable embedding provider (local/remote)
- [ ] Vector index (FAISS or alternative) and cluster assignment (KMeans/HDBSCAN)
- [ ] Cluster stats (size, median/mean VPD, top tokens/entities)
- [ ] Gap analysis (performance vs saturation)

## Phase 4 — Opportunity Scoring
- [x] Define a first-pass Opportunity Score (sample-level, in-memory)
  - [x] Z-score normalization per sample (not per cluster yet)
  - [x] Penalize saturation via simple token frequency in current sample
  - [x] Expose weights via config/env
  - [x] CLI flags for all weights (`--opp-w-vpd`, etc.)
  - [x] Predefined weight profiles (exploration, evergreen, trending, balanced)
  - [x] Profile management (`--profiles`, `--profile`)
  - [x] Slope weight integration (`YTMINER_OPP_W_SLOPE`)
- [x] Ranking view and explanations (why this is recommended)
- [x] Comprehensive UI with active weights display
- [x] Top 5 opportunities with detailed reasoning

## Phase 5 — UX & Docs
- [x] Update interactive flows to include transcript toggle and insights
- [x] Comprehensive documentation (README.md, METRICS.md, ANALYSES.md)
- [x] Architecture documentation and design principles
- [x] Weight profiles documentation and examples
- [x] Testing documentation with gotestsum
- [ ] Add "Emerging Now", "Gaps", and "Cluster Leaders" views (Phase 3 dependency)

## Phase 6 — Testing & Quality
- [x] Unit tests for domain logic (metrics, score)
- [x] Golden tests for Opportunity Score end-to-end
- [x] Property-based testing for monotonicity
- [x] Integration tests for platform adapters
- [x] GitHub Actions CI with coverage gates
- [x] Test utilities and fixtures
- [x] Comprehensive test coverage

## Phase 7 — Architecture & Maintainability
- [x] Clean Architecture implementation (Ports & Adapters)
- [x] Domain-driven design with pure functions
- [x] Platform adapters for external integrations
- [x] Functional core, imperative shell pattern
- [x] Configurable weights and profiles system
- [x] Modular, testable codebase

## Nice-to-haves
- [ ] Whisper ASR fallback when no captions available (opt-in)
- [ ] Thumbnail OCR and title heuristics (numbers/power words/curiosity)
- [ ] Comment sentiment and question mining
- [ ] OAuth 2.0 implementation for official YouTube Data API v3 access

## Current Status Summary
- **Phase 1**: 100% Complete (with YouTube blocking handling)
- **Phase 2**: 60% Complete (VPD7/VPD30/Slope implemented, persistence pending)
- **Phase 3**: 0% Complete (embeddings & clustering)
- **Phase 4**: 100% Complete (full Opportunity Score system)
- **Phase 5**: 90% Complete (docs complete, advanced views pending)
- **Phase 6**: 100% Complete (comprehensive testing)
- **Phase 7**: 100% Complete (clean architecture)

**Overall Progress**: ~75% Complete
**Next Priority**: Phase 2 completion (temporal persistence) or Phase 3 (embeddings)
